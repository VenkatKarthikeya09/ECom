<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Checkout - Review</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<div th:replace="fragments/navbar :: navbar"></div>
<main class="container my-5 pt-5">
    <h3 class="mb-3">Review your cart</h3>
    <div class="table-responsive">
        <table class="table align-middle">
            <thead>
            <tr>
                <th>Product</th>
                <th>Name</th>
                <th>Price</th>
                <th>Qty</th>
                <th>Subtotal</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${#lists.isEmpty(reviewItems)}">
                <td colspan="5" class="text-center text-muted">No items to review.</td>
            </tr>
            <tr th:each="ri : ${reviewItems}">
                <td><img th:src="@{'/img-proxy'(url=${ri.imageUrl}, w=120, h=120)}" class="img-thumbnail me-3" style="width:60px;height:60px;object-fit:cover;border-radius:6px;" th:alt="${ri.name}"></td>
                <td th:text="${ri.name}"></td>
                <td>₹ <span th:text="${#numbers.formatDecimal(ri.price, 1, 'NONE', 2, 'POINT')}"></span></td>
                <td>
                    <form method="post" action="/checkout/update" class="d-flex gap-2" th:if="${ri.productId != null}">
                        <input type="hidden" name="productId" th:value="${ri.productId}">
                        <input class="form-control" type="number" name="quantity" th:value="${ri.quantity}" min="0" style="width:90px;">
                        <button class="btn btn-outline-primary btn-sm">Update</button>
                    </form>
                    <span th:if="${ri.productId == null}" th:text="${ri.quantity}"></span>
                </td>
                <td>₹ <span th:text="${#numbers.formatDecimal(ri.price * ri.quantity, 1, 'NONE', 2, 'POINT')}"></span></td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="d-flex justify-content-between align-items-center">
        <a class="btn btn-outline-secondary" href="/checkout/address">Back to address</a>
        <div class="fs-5">Total: ₹ <span th:text="${#numbers.formatDecimal(totalPrice, 1, 'NONE', 2, 'POINT')}"></span></div>
        <a class="btn btn-gold" href="/checkout/payment">Continue to payment</a>
    </div>
</main>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 